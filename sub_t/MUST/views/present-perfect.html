<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUST QUEST: Presente Perfecto</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Caveat+Brush&family=Poppins:wght@400;700&family=Press+Start+2P&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>

<body>
    <!-- Sonidos del juego -->
    <audio id="clickSound" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"
        preload="auto"></audio>
    <audio id="correctSound" src="https://assets.mixkit.co/active_storage/sfx/270/270-preview.mp3"
        preload="auto"></audio>
    <audio id="wrongSound" src="https://assets.mixkit.co/active_storage/sfx/131/131-preview.mp3" preload="auto"></audio>
    <audio id="levelUpSound" src="https://assets.mixkit.co/active_storage/sfx/2020/2020-preview.mp3"
        preload="auto"></audio>
    <audio id="backgroundMusic" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3" loop
        preload="auto"></audio>

    <!-- Estrellas de fondo -->
    <div class="stars-container">
        <div id="stars"></div>
        <div id="stars2"></div>
        <div id="stars3"></div>
    </div>

    <div class="game-container">
        <div class="game-header">
            <div class="logo-container">
                <h1 class="game-logo animate__animated animate__bounceIn">MUST<span>QUEST</span></h1>
                <p class="game-subtitle">Reino del Presente Perfecto - Nivel 3</p>
            </div>

            <div class="game-stats">
                <div class="stats-item">
                    <div class="stats-icon stars-icon">★</div>
                    <div class="stats-value" id="stars-count">0</div>
                </div>
                <div class="stats-item">
                    <div class="stats-icon progress-icon"><i class="fas fa-tasks"></i></div>
                    <div class="stats-value" id="progress-count">0/5</div>
                </div>
                <div class="stats-item">
                    <button id="sound-toggle" class="sound-btn"><i class="fas fa-volume-up"></i></button>
                </div>
            </div>
        </div>

        <div class="level-container">
            <div class="level-sidebar">
                <div class="sidebar-section">
                    <h3>Contenido</h3>
                    <ul class="sidebar-nav">
                        <li><a href="#intro" class="active">Introducción</a></li>
                        <li><a href="#theory">Teoría</a></li>
                        <li><a href="#examples">Ejemplos</a></li>
                        <li><a href="#practice">Práctica</a></li>
                        <li><a href="#challenge">Desafío</a></li>
                    </ul>
                </div>

                <div class="sidebar-character">
                    <div id="character-avatar-button"
                        class="character-avatar-button animate__animated animate__pulse animate__infinite"
                        onclick="goToAvatarSelection()">
                        <div id="character-display">
                            <!-- Avatar se cargará aquí -->
                            <img src="https://i.imgur.com/0MbrTTX.png" alt="Haz clic para personalizar tu avatar"
                                id="character-img">
                        </div>
                        <div class="avatar-overlay">
                            <i class="fas fa-edit"></i>
                            <span>Personalizar</span>
                        </div>
                    </div>
                    <div class="speech-bubble" id="speech-bubble">
                        <p id="character-speech">¡Recuerda! MUST en presente perfecto se usa para expresar deducciones
                            lógicas sobre acciones
                            que han ocurrido recientemente.</p>
                    </div>
                </div>
            </div>

            <div class="level-content">
                <div id="intro" class="level-section active">
                    <h2 class="section-title">Bienvenido al Reino del Presente Perfecto</h2>
                    <div class="section-content">
                        <div class="character-dialogue">

                            <div class="dialogue-bubble">
                                <p>¡Bienvenido al Reino del Presente Perfecto! Aquí aprenderás a usar MUST para expresar
                                    deducciones lógicas sobre acciones que acaban de completarse o tienen un resultado
                                    visible en el presente. ¡Este nivel requiere de todo tu poder de deducción!</p>
                            </div>
                        </div>

                        <div class="intro-summary">
                            <h3>En este nivel aprenderás:</h3>
                            <ul>
                                <li>Cómo usar MUST con el presente perfecto</li>
                                <li>La estructura de MUST + have + participio pasado</li>
                                <li>Cómo expresar deducciones sobre acciones pasadas con resultados presentes</li>
                                <li>Cuándo usar MUST HAVE para expresar conclusiones lógicas</li>
                            </ul>

                            <div class="intro-action">
                                <button class="action-btn" onclick="navigateToSection('theory')">¡Comencemos! <i
                                        class="fas fa-arrow-right"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="theory" class="level-section">
                    <h2 class="section-title">Teoría: MUST en Presente Perfecto</h2>
                    <div class="section-content">
                        <div class="theory-explanation">
                            <h3>MUST con el presente perfecto</h3>
                            <p>Cuando usamos MUST con el presente perfecto, estamos haciendo deducciones lógicas sobre
                                acciones pasadas basadas en la evidencia que vemos en el presente.</p>

                            <div class="theory-card">
                                <div class="card-icon"><i class="fas fa-lightbulb"></i></div>
                                <div class="card-content">
                                    <h4>Deducción Lógica sobre Acciones Pasadas</h4>
                                    <p>Una conclusión basada en evidencia presente sobre algo que ya ha ocurrido.</p>
                                    <div class="card-example">
                                        <p>The ground is wet. It <strong>must have rained</strong> last night.</p>
                                        <p>She looks tired. She <strong>must have worked</strong> all night.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="theory-card">
                                <div class="card-icon"><i class="fas fa-ban"></i></div>
                                <div class="card-content">
                                    <h4>Deducción Negativa (forma negativa)</h4>
                                    <p>Una conclusión de que algo no ocurrió, basada en la evidencia presente.</p>
                                    <div class="card-example">
                                        <p>The cake is still whole. He <strong>must not have eaten</strong> any of it.
                                        </p>
                                        <p>She still looks confused. She <strong>mustn't have understood</strong> the
                                            instructions.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="theory-card">
                                <div class="card-icon"><i class="fas fa-question-circle"></i></div>
                                <div class="card-content">
                                    <h4>Preguntas sobre Deducciones</h4>
                                    <p>Preguntas para verificar una deducción lógica sobre una acción pasada.</p>
                                    <div class="card-example">
                                        <p>She got an A on the test. <strong>Must she have studied</strong> a lot?</p>
                                        <p>They arrived late. <strong>Must they have missed</strong> the bus?</p>
                                    </div>
                                </div>
                            </div>

                            <h3>Estructura Gramatical</h3>
                            <div class="grammar-structure">
                                <div class="structure-item">
                                    <h4>Afirmativo</h4>
                                    <p class="formula">Sujeto + must + have + participio pasado + complemento</p>
                                </div>

                                <div class="structure-item">
                                    <h4>Negativo</h4>
                                    <p class="formula">Sujeto + must not (mustn't) + have + participio pasado +
                                        complemento</p>
                                </div>

                                <div class="structure-item">
                                    <h4>Interrogativo</h4>
                                    <p class="formula">Must + sujeto + have + participio pasado + complemento + ?</p>
                                </div>
                            </div>

                            <div class="theory-note">
                                <h4><i class="fas fa-info-circle"></i> Importante</h4>
                                <p>MUST en presente perfecto (must have + participio pasado) siempre expresa una
                                    deducción lógica sobre el pasado, no una obligación pasada.</p>
                            </div>

                            <div class="section-navigation">
                                <button class="nav-btn" onclick="navigateToSection('intro')"><i
                                        class="fas fa-arrow-left"></i> Anterior</button>
                                <button class="nav-btn" onclick="navigateToSection('examples')">Siguiente <i
                                        class="fas fa-arrow-right"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="examples" class="level-section">
                    <h2 class="section-title">Ejemplos en Contexto</h2>
                    <div class="section-content">
                        <div class="examples-container">
                            <div class="example-scenario">
                                <h3>Escenario 1: Resolviendo un Misterio</h3>
                                <div class="scenario-illustration mystery-bg">
                                    <div class="scenario-bubble detective">
                                        <p>The window is broken and there are muddy footprints. Someone <strong>must
                                                have broken in</strong> last night.</p>
                                    </div>
                                    <div class="scenario-bubble assistant">
                                        <p>But nothing is missing. They <strong>must not have found</strong> what they
                                            were looking for.</p>
                                    </div>
                                    <div class="scenario-bubble detective">
                                        <p>Look, the alarm is disabled. They <strong>must have known</strong> the
                                            security code.</p>
                                    </div>
                                </div>
                                <div class="scenario-explanation">
                                    <p>En este escenario, los detectives usan "must have + participio pasado" para hacer
                                        deducciones sobre lo que ocurrió basándose en la evidencia que encuentran.</p>
                                </div>
                            </div>

                            <div class="example-scenario">
                                <h3>Escenario 2: Después de una Fiesta</h3>
                                <div class="scenario-illustration party-bg">
                                    <div class="scenario-bubble person1">
                                        <p>There are so many dirty dishes! It <strong>must have been</strong> a great
                                            party.</p>
                                    </div>
                                    <div class="scenario-bubble person2">
                                        <p>John looks so tired. He <strong>must have stayed up</strong> all night
                                            cleaning.</p>
                                    </div>
                                    <div class="scenario-bubble person1">
                                        <p>But the floor is still dirty. He <strong>must not have had</strong> enough
                                            time to clean everything.</p>
                                    </div>
                                </div>
                                <div class="scenario-explanation">
                                    <p>En estos ejemplos, las personas hacen deducciones sobre eventos pasados basados
                                        en lo que ven en el presente usando "must have + participio pasado".</p>
                                </div>
                            </div>

                            <div class="example-scenario">
                                <h3>Escenario 3: Resultados de un Examen</h3>
                                <div class="scenario-illustration school-bg">
                                    <div class="scenario-bubble teacher">
                                        <p>Maria got a perfect score. She <strong>must have studied</strong> very hard.
                                        </p>
                                    </div>
                                    <div class="scenario-bubble student1">
                                        <p>But Pedro failed. He <strong>must not have prepared</strong> at all.</p>
                                    </div>
                                    <div class="scenario-bubble teacher">
                                        <p>And Ana got a B despite being absent last week. She <strong>must have caught
                                                up</strong> with the lessons.</p>
                                    </div>
                                </div>
                                <div class="scenario-explanation">
                                    <p>El profesor y los estudiantes usan "must have + participio pasado" para hacer
                                        deducciones lógicas sobre la preparación de los estudiantes basándose en sus
                                        resultados.</p>
                                </div>
                            </div>

                            <div class="section-navigation">
                                <button class="nav-btn" onclick="navigateToSection('theory')"><i
                                        class="fas fa-arrow-left"></i> Anterior</button>
                                <button class="nav-btn" onclick="navigateToSection('practice')">Siguiente <i
                                        class="fas fa-arrow-right"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="practice" class="level-section">
                    <h2 class="section-title">Práctica Interactiva</h2>
                    <div class="section-content">
                        <div class="practice-container">
                            <div class="practice-intro">
                                <p>Ahora es tu turno de practicar. Completa los siguientes ejercicios para reforzar tu
                                    conocimiento sobre MUST en presente perfecto.</p>
                            </div>

                            <div class="exercise-set">
                                <h3>Ejercicio 1: Completar las Oraciones</h3>
                                <p>Selecciona la opción correcta para completar cada oración:</p>

                                <div class="exercise" data-num="1">
                                    <p class="question-text">The streets are wet. It __________ during the night.</p>
                                    <div class="options">
                                        <button class="option">must rained</button>
                                        <button class="option" data-correct="true">must have rained</button>
                                        <button class="option">must be rained</button>
                                    </div>
                                    <div class="feedback"></div>
                                </div>

                                <div class="exercise" data-num="2">
                                    <p class="question-text">She passed the exam without studying. She __________ very
                                        intelligent.</p>
                                    <div class="options">
                                        <button class="option">must be</button>
                                        <button class="option">must having been</button>
                                        <button class="option" data-correct="true">must be</button>
                                    </div>
                                    <div class="feedback"></div>
                                </div>

                                <div class="exercise" data-num="3">
                                    <p class="question-text">His car isn't in the garage. He __________ to work.</p>
                                    <div class="options">
                                        <button class="option">must gone</button>
                                        <button class="option" data-correct="true">must have gone</button>
                                        <button class="option">must going</button>
                                    </div>
                                    <div class="feedback"></div>
                                </div>
                            </div>

                            <div class="exercise-set">
                                <h3>Ejercicio 2: Transformar Oraciones</h3>
                                <p>Transforma las siguientes oraciones según se indica:</p>

                                <div class="transform-exercise" data-num="4">
                                    <p class="original">She must have forgotten her keys. (Hacer negativa)</p>
                                    <div class="answer-input">
                                        <input type="text" class="transform-input"
                                            data-answer="She must not have forgotten her keys,She mustn't have forgotten her keys">
                                        <button class="check-btn">Comprobar</button>
                                    </div>
                                    <div class="feedback"></div>
                                </div>

                                <div class="transform-exercise" data-num="5">
                                    <p class="original">They must have arrived late. (Hacer interrogativa)</p>
                                    <div class="answer-input">
                                        <input type="text" class="transform-input"
                                            data-answer="Must they have arrived late?">
                                        <button class="check-btn">Comprobar</button>
                                    </div>
                                    <div class="feedback"></div>
                                </div>
                            </div>

                            <div class="section-navigation">
                                <button class="nav-btn" onclick="navigateToSection('examples')"><i
                                        class="fas fa-arrow-left"></i> Anterior</button>
                                <button class="nav-btn" onclick="navigateToSection('challenge')">Siguiente <i
                                        class="fas fa-arrow-right"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="challenge" class="level-section">
                    <h2 class="section-title">Desafío Final</h2>
                    <div class="section-content">
                        <div class="challenge-container">
                            <div class="challenge-intro">
                                <div class="character-dialogue">
                                    <div class="dialogue-bubble">
                                        <p>¡Ha llegado el momento del Desafío Final! Demuestra tu dominio de MUST en
                                            presente perfecto completando este quiz. ¡Necesitas al menos 7 respuestas
                                            correctas para superar el nivel!</p>
                                    </div>
                                </div>
                            </div>

                            <div class="challenge-quiz">
                                <div class="quiz-progress">
                                    <div class="progress-bar">
                                        <div class="progress" id="quiz-progress-bar" style="width: 0%"></div>
                                    </div>
                                    <p class="progress-text"><span id="current-question">0</span>/<span
                                            id="total-questions">10</span></p>
                                </div>

                                <div id="quiz-container">
                                    <!-- Las preguntas se cargarán dinámicamente mediante JavaScript -->
                                </div>

                                <div class="quiz-navigation">
                                    <button id="prev-question" class="quiz-nav-btn" disabled><i
                                            class="fas fa-arrow-left"></i> Anterior</button>
                                    <button id="next-question" class="quiz-nav-btn">Siguiente <i
                                            class="fas fa-arrow-right"></i></button>
                                </div>
                            </div>

                            <div id="results-container" class="results-container" style="display: none;">
                                <h3 class="results-title">Resultados del Desafío</h3>
                                <div class="results-score">
                                    <div class="score-circle">
                                        <span id="final-score">0/10</span>
                                    </div>
                                </div>

                                <div class="results-message" id="results-message">
                                    <!-- El mensaje se cargará dinámicamente según la puntuación -->
                                </div>

                                <div class="results-stars" id="results-stars">
                                    <!-- Las estrellas se mostrarán según la puntuación -->
                                </div>

                                <div class="results-actions">
                                    <button id="retry-quiz" class="action-btn">Intentar de nuevo</button>
                                    <button id="complete-level" class="action-btn primary">Completar Nivel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-controls">
            <button id="back-to-map" class="control-btn" onclick="goToMap()"><i class="fas fa-map-marked-alt"></i>
                Volver al Mapa</button>
            <button id="check-progress" class="control-btn primary" onclick="checkProgress()"><i
                    class="fas fa-trophy"></i> Ver Progreso</button>
        </div>
    </div>

    <script src="../scripts/main.js"></script>
    <script src="../scripts/levels.js"></script>
    <script src="../scripts/present-perfect.js"></script>
</body>

</html>